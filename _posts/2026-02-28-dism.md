---
layout: post
title: "Dism 使用指南"
date: 2026-02-28
categories: [工程,技术]
author: agppd
---


DISM（部署映像服务和管理工具）是Windows系统内置的强大命令行工具，主要用于修复系统映像文件、管理驱动程序和卸载更新。本文将介绍最基本的DISM操作。

## 1. DISM简介

DISM（Deployment Imaging Service and Management）是Windows系统中用于服务和管理映像文件的命令行工具。它可以：
- 扫描和修复损坏的系统文件
- 管理驱动程序
- 卸载Windows更新
- 准备和修改Windows映像

当系统出现不稳定、蓝屏或文件损坏时，DISM是比SFC（系统文件检查器）更底层的修复工具。

~~我一直认为DISM应该叫 Developer Important System Manager~~

## 2. 准备工作

### 2.1 以管理员身份打开命令提示符
所有DISM操作都需要管理员权限：

1. 点击「开始」按钮
2. 输入`cmd`或「命令提示符」
3. 右键点击搜索结果中的「命令提示符」
4. 选择「以管理员身份运行」
5. 如收到用户账户控制提示，点击「是」

> 注意：普通权限运行DISM会提示"错误: 740 需要提升权限"。

## 3. 核心操作：修复系统映像

这是DISM最常用、最重要的功能，用于修复损坏的系统文件。

### 3.1 基本修复命令

按顺序执行以下三条命令：

```
# 第一步：检查系统映像健康状态
DISM /Online /Cleanup-Image /CheckHealth

# 第二步：扫描系统映像完整性
DISM /Online /Cleanup-Image /ScanHealth

# 第三步：修复系统映像
DISM /Online /Cleanup-Image /RestoreHealth
```

**命令说明**：
- `/Online`：指定操作针对当前正在运行的操作系统
- `/Cleanup-Image`：触发系统映像清理和检查
- `/CheckHealth`：快速检查是否检测到损坏
- `/ScanHealth`：执行更全面的损坏扫描
- `/RestoreHealth`：扫描并自动修复损坏的文件

### 3.2 修复过程说明

- **耗时**：根据系统状态和网络速度，可能需要10-30分钟
- **现象**：命令可能在20%、40%、62%或80%处暂停，这是正常现象
- **网络需求**：`/RestoreHealth`默认会从Windows Update服务器下载修复文件，需要网络连接
- **完成提示**：成功完成后会显示"还原操作已成功完成"

### 3.3 使用本地源修复（无网络时）

如果系统无法连接网络，或默认修复失败，可以使用Windows安装介质作为修复源：

```
DISM /Online /Cleanup-Image /RestoreHealth /Source:D:\Sources\install.wim /LimitAccess
```

> 说明：将`D:`替换为你的安装介质盘符，`/LimitAccess`阻止DISM联系Windows Update。

### 3.4 修复后操作

DISM修复完成后，建议运行SFC扫描来修复剩余的系统文件问题：

```
sfc /scannow
```

## 4. 进阶操作：驱动管理

### 4.1 查看已安装的驱动

```
dism /online /get-drivers
```

### 4.2 向离线映像添加驱动

如需修改Windows安装镜像（如boot.wim），先挂载映像再添加驱动：

```
# 挂载映像
dism /Mount-Wim /WimFile:C:\boot.wim /Index:1 /MountDir:C:\Mount

# 添加驱动（包含子文件夹）
dism /Image:C:\Mount /Add-Driver /Driver:C:\Drivers /Recurse

# 保存更改并卸载
dism /Unmount-Wim /MountDir:C:\Mount /Commit
```

## 5. 进阶操作：卸载Windows更新

当某个更新导致问题时，可以使用DISM卸载它。

### 5.1 查看已安装的更新

```
dism /online /get-packages
```

执行后会列出所有更新包，记录下要卸载的"Package Identity"（完整的包名称）。

### 5.2 卸载特定更新

```
dism /online /remove-package /packagename:Package_for_KBXXXXXXX~31bf3856ad364e35~amd64~~10.0.1.0
```

> 注意：将包名称替换为实际值，注意大小写和空格。

### 5.3 验证卸载结果

再次运行`dism /online /get-packages`，确认该更新已不在列表中。完成后建议重启电脑。

## 6. 常用命令速查表

| 操作类别 | 命令 | 说明 |
|---------|------|------|
| **系统修复** | `dism /online /cleanup-image /restorehealth` | 修复当前系统映像  |
| **健康检查** | `dism /online /cleanup-image /checkhealth` | 快速检查是否损坏  |
| **完整扫描** | `dism /online /cleanup-image /scanhealth` | 深度扫描系统映像  |
| **查看更新** | `dism /online /get-packages` | 列出已安装更新  |
| **卸载更新** | `dism /online /remove-package /packagename:名称` | 删除指定更新  |
| **查看驱动** | `dism /online /get-drivers` | 列出已安装驱动  |
| **挂载映像** | `dism /Mount-Wim /WimFile:路径 /Index:索引 /MountDir:目录` | 挂载WIM文件  |
| **保存更改** | `dism /Unmount-Wim /MountDir:目录 /Commit` | 卸载并保存修改  |
| **查看帮助** | `dism /?` | 显示所有命令参数  |

## 7. 常见问题与注意事项

### 7.1 常见错误及解决方法

| 错误 | 可能原因 | 解决方法 |
|------|---------|---------|
| 错误 740 | 权限不足 | 以管理员身份运行命令提示符  |
| 错误 0x800f081f | 源文件找不到 | 使用本地源或检查网络连接  |
| 指定文件找不到 | 路径错误 | 检查文件路径和语法  |
| 修复失败 | 系统损坏严重 | 尝试重启后再次运行，或使用安装介质  |

### 7.2 重要注意事项

1. **管理员权限**：必须使用管理员权限运行 
2. **网络连接**：默认修复需要连接Windows Update 
3. **耐心等待**：DISM操作可能需要较长时间，切勿中途中断 
4. **备份数据**：虽然DISM不会删除个人文件，但建议提前备份重要数据 
5. **查看日志**：如果出错，可查看日志文件 `C:\Windows\Logs\DISM\dism.log` 

~~来自作者的吐槽：这dism.log为什么不能有个定时清理呢？~~

## 8. 总结

DISM是Windows系统中重要的维护工具，掌握基本命令可以解决大部分系统文件问题。

对于普通维护系统的用户，记住这三步就够了：

1. 以管理员身份打开命令提示符
2. 运行 `DISM /Online /Cleanup-Image /RestoreHealth` 修复系统
3. 运行 `sfc /scannow` 完成最终修复
