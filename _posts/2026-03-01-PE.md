---
layout: post
title: "PE制作教程"
date: 2026-03-01
categories: [杂谈,技术,工程]
author: agppd
---

<h2><center><font color="red"> 此指南只适用于Windows </font></center></h2>

## 前情提要

其实，以前时没有 `PE` 的，我们以前使用 `DOS` 盘，

但是那东西太古老了……

所以，后来就有了 `PE`。

## 下载与安装官方工具

首先，我们需要从微软官方下载并安装两个关键组件。

1.  **下载 Windows ADK**：访问微软官方网站，下载最新版本的 Windows ADK 。
2.  **下载 WinPE 加载项**：同样在下载页面，找到并下载 **Windows PE 加载项**。这是专门为 ADK 添加 WinPE 功能的补充安装包 。
3.  **安装组件**：
*   先运行 `adksetup.exe` 安装 ADK。在“选择要安装的功能”界面，**只需勾选“部署工具”** 即可，其他功能可按需选择，但对于制作基础 WinPE 来说不是必需的 。
*   安装完成后，运行 `adkwinpesetup.exe` 安装 WinPE 加载项。同样，在功能选择界面，确保 **“Windows 预安装环境 (Windows PE)”** 被选中 。

请注意，如果你的安装卡死，请阅读以下补充内容，若没问题，直接跳转。

1.  **下载 Windows ADK**：访问微软官方网站，下载最新版本的 Windows ADK 。
2.  **下载 WinPE 加载项**：同样在下载页面，找到并下载 **Windows PE 加载项**。这是专门为 ADK 添加 WinPE 功能的补充安装包 。
3.   **安装组件**：
*   先运行 `adksetup.exe` 安装 ADK。选择下面的，也就是可以为其他电脑安装的选项，进行下载，下载完成后，不要运行这个 `adksetup.exe` ，运行你使用它下载的 `adksetup.exe` ，然后就可以正常安装，勾选与上面一致。

**注意：在制作PE完成以前，也就是你需要ADK的时候一定不要删除你刚刚下载好的内容，如果删除，后面ADK出现问题，无法删除！！！**
*   安装完成后，运行 `adkwinpesetup.exe` 安装 WinPE 加载项。同样，如上，勾选与上面一致。

**再次强调：在制作PE完成以前，也就是你需要ADK的时候一定不要删除你刚刚下载好的内容，如果删除，后面ADK出现问题，无法删除！！！**

**好吧，我都考虑到你一定会嫌弃它大而删除它的，如果你真的删除了，找一台可以正常下载的电脑重复上述步骤（需要保证版本一致），安装后传到你电脑上，然后控制面板删除时，路径选择传送到你电脑上的文件夹，然后进行删除。**

Q：不能在我自己电脑上重复此过程吗？

A：我赌你肯定没有删除，否则你再次下载时，就会提示你已经下载，无法下载。

## 制作WinPE启动U盘

工具安装好后，我们就可以开始制作可启动的U盘了。**请注意，此操作会格式化U盘，请提前备份重要数据！**

1.  **以管理员身份运行**：点击“开始”菜单，搜索“部署和映像工具环境”，右键点击并选择 **“以管理员身份运行”** 。
2.  **创建工作文件**：在打开的命令提示符中，输入以下命令来创建一个用于存放 WinPE 源文件的文件夹（请将 `C:\WinPE_amd64` 替换为你想要的实际路径）：
```cmd
copype amd64 C:\WinPE_amd64
```
如果你的电脑是32位的，请将 `amd64` 替换为 `x86` 。
3.  **写入U盘**：插入你的U盘，记下它的盘符（例如 E:）。然后输入以下命令，将制作好的 WinPE 文件写入U盘：
```cmd
MakeWinPEMedia /UFD C:\WinPE_amd64 E:
```
**请务必将 `E:` 替换为你的U盘实际盘符。** 命令执行后，会提示你确认格式化U盘，确认后等待完成即可 。

## 制作WinPE启动ISO镜像

如果你更倾向于制作一个ISO镜像文件，以便刻录到光盘或在虚拟机中使用，只需将最后一步的命令替换为：
```cmd
MakeWinPEMedia /ISO C:\WinPE_amd64 C:\WinPE_amd64\WinPE.iso
```
这会在 `C:\WinPE_amd64` 文件夹下生成一个名为 `WinPE.iso` 的镜像文件 。

## 自定义你的WinPE

基础的 WinPE 只提供一个命令行窗口，功能有限。通过以下方法，你可以为其添加驱动、软件等，让它更强大 。

*   **添加驱动**：假设你有一个网卡驱动 `C:\MyDrivers\netcard.inf`，可以使用以下命令将其集成到 WinPE 中：
```cmd
dism /Add-Driver /Image:"C:\WinPE_amd64\mount" /Driver:"C:\MyDrivers\netcard.inf"
```
*   **添加软件或文件**：你可以直接将需要的绿色软件或文件复制到 `C:\WinPE_amd64\mount\` 目录下的相应位置（例如，放到 `Program Files` 文件夹里）。这些文件在启动 WinPE 后会出现在 X 盘中。
*   **修改启动脚本**：`C:\WinPE_amd64\mount\Windows\System32\Startnet.cmd` 是 WinPE 启动时自动运行的脚本。你可以编辑它，以便在启动时自动执行一些命令，比如初始化网络 `wpeinit` 或启动一个图形化外壳程序。

详细教程可见本网站其他相关文章

**新手建议直接到此为止，不要再继续更改了**

## 图形化PE

是的，其实现在大部分用的都是图形化PE。

功能更全，也更加庞大。

我个人还是推荐，为了快捷，使用命令行。

我个人推荐 `微PE` ， `Hiren's BootCD PE` ， `MediCat USB` 。

让 `Deepseek` 写了个推荐表格，如下

| 特性 | 微PE工具箱 | MediCat USB | Hiren's BootCD PE |
| :--- | :--- | :--- | :--- |
| **核心定位** | 轻量纯净的PE基础平台 | 全能型“瑞士军刀”工具合集 | 经典传承的全面维护工具集 |
| **体积大小** | 约 **300MB** | 超过 **20GB** | 约 **2-3GB** |
| **图形界面** | 标准Windows PE界面（需自备工具） | 自带完整“Mini Windows 10”图形环境，集成数百款便携软件 | 标准Windows 10/11 PE图形界面，预装精选工具 |
| **工具集成** | **无预装工具**，用户可按需自行添加 | **海量集成**：包含数十个独立ISO镜像（Linux发行版、杀毒盘等）和数百款Windows便携软件 | **精选集成**：涵盖数据恢复、磁盘克隆、密码重置、硬件诊断等领域的顶尖免费工具 |
| **启动方式** | 原生支持 UEFI/Legacy 双启动 | 基于 Ventoy，支持 UEFI/Legacy 双启动，可启动绝大多数ISO | 支持 UEFI/Legacy 双启动，对现代硬件兼容性好 |
| **纯净度** | ⭐⭐⭐⭐⭐ 极高（公认纯净，无任何捆绑） | ⭐⭐⭐⭐⭐ 极高（开源社区项目，无捆绑） | ⭐⭐⭐⭐⭐ 极高（基于免费工具构建，全球信誉卓著） |
| **适用人群** | 追求稳定、纯净，希望自行组合工具的技术爱好者和专业人士 | IT专业技术人员、数据恢复专家、希望“一盘走天下”的高级玩家 | 任何水平的用户，尤其是从DOS时代走来的老玩家，以及需要可靠工具集的IT运维人员 |
| **优点** | 极致轻量，启动快，高度灵活，无任何多余组件 | 功能极其强大，几乎覆盖所有维护场景，无需再找额外工具 | 工具精炼实用，界面熟悉，上手容易，口碑经久不衰 |
| **缺点** | 基础PE无预装工具，需要用户自己添加，对新手有一定门槛 | 体积巨大，需要至少32GB的U盘，部分工具可能过旧 | 体积适中，但工具集相对固定，不如MediCat USB可拓展性强 |
| **推荐U盘容量** | 1GB 以上即可 | **32GB 或更大** | 4GB 以上即可 |

我个人现在在使用 `Hiren's BootCD PE`。