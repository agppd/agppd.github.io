---
layout: post
title: "重装Windows系统"
date: 2026-02-28
categories: [杂谈,技术]
author: agppd
---

<h2><center><font color="red"> 此指南只适用于Windows </font></center></h2>

**重装系统的方法远不止这一种，本文讲解最通用，最稳妥，最好调试，最好处理，最快的方法**

<h4><center><font color="red"> 新手建议直接按照ISO的引导去安装 </font></center></h4>

**若无特殊强调，默认的PE就是 Windows PE**

关于PE的制作可以在本网站查看对应的文章

## 第一种情况 UEFI + GPT + WIM

###  第一步：在PE中准备好硬盘（分区与格式化）
进入PE桌面后，首先需要明确哪块硬盘是目标盘，并为其创建正确的分区结构

1.  **使用DiskPart工具**：
*   在CMD中依次输入以下命令（每输一行按一次回车）：
```cmd
diskpart
list disk              # 列出所有磁盘，确认你的目标磁盘编号（通常是0）
select disk 0          # 选中目标磁盘（请根据上一步结果确认编号）
clean                  # 清空磁盘，删除所有现有分区
convert gpt            # 将磁盘转换为GPT分区表
```
2.  **创建分区**：
*   紧接上步，继续输入：

```cmd

create partition efi size=100 # 创建EFI系统分区（UEFI启动必需）
format quick fs=fat32 label="System"
assign letter="S"      # 给EFI分区分配盘符S

create partition msr # （可选）创建恢复分区注意，恢复分区不需格式化与分配盘符

create partition primary # 创建主系统分区（装Windows的地方）
format quick fs=ntfs label="Windows"
assign letter="W"      # 给系统分区分配盘符W

exit                   # 退出diskpart
```

*   **参数说明**：`size=100` 表示分区大小为100MB，`fs=` 指定文件系统格式

###  第二步：找到并应用系统镜像
接下来，你需要告诉DISM命令，要把哪个系统安装到你刚准备好的 `S:` 盘里

1.  **定位镜像文件**：假设你的U盘在PE里被识别为 `D:` 盘，且系统镜像 `Windows.iso` 就放在U盘根目录
2.  **查看镜像包含的系统版本**：一个镜像文件（install.wim）里可能包含多个版本（如家庭版、专业版），输入以下命令查看：
```cmd
dism /get-wiminfo /wimfile:D:\sources\install.wim
```
记下你想要安装的版本对应的**索引号**（Index）
3.  **应用镜像到系统盘**：
```cmd
dism /apply-image /imagefile:D:\sources\install.wim /index:1 /applydir:S:\
```
*   **参数说明**：`/index:1` 就是上一步查到的版本号，`/applydir:S:\` 指定释放到我们刚准备好的系统盘
*   等待进度条跑到100%，出现“操作成功完成”的提示

###  第三步：修复引导
镜像虽然解压到硬盘了，但电脑还不知道怎么从这块硬盘启动需要用 `bcdboot` 命令来修复引导

1.  **写入引导文件**：
```cmd
bcdboot S:\Windows /s S: /f UEFI
```
**参数说明**：这个命令的意思是将 `S:` 盘Windows目录下的引导文件，复制到 `S:` 盘（即我们创建的EFI分区），并创建UEFI模式的引导菜单

2. 输入 `exit` 关闭命令行，然后重启电脑记得在重启时拔掉U盘接下来，你就会看到熟悉的 `Windows` 设置界面了

## 第二种情况 Legacy BIOS + MBR + WIM

### 1. 进入PE
- 从U盘启动进入PE

### 2. 使用 DiskPart 对硬盘进行 MBR 分区
在CMD中逐行输入以下命令（每行回车）：

```cmd
diskpart
list disk              # 列出所有磁盘，确认目标磁盘编号（通常为0）
select disk 0          # 选中目标磁盘（请根据实际情况修改）
clean                  # 清空磁盘所有分区
convert mbr            # 转换为MBR分区表（关键！）

# 创建主分区（整个磁盘分一个区，你也可以分多个，但系统分区必须是主分区）
create partition primary size=50000    # 示例：创建50GB主分区，大小按需调整
format fs=ntfs quick                    # 快速格式化为NTFS
active                                   # 激活该分区（BIOS启动必需！）
assign letter=C                          # 分配盘符C

# 如果你还想创建其他分区，继续 create partition extended ... 这里不赘述
exit                                     # 退出diskpart
```
*注：如果你想用满整个磁盘，可以不用 `size` 参数，直接 `create partition primary`*

### 3. 查看系统镜像中的版本索引
假设你的U盘在PE里被识别为 `D:` 盘（请根据实际情况确认盘符）

```cmd
dism /get-wiminfo /wimfile:D:\sources\install.wim
```
记下你想要安装的版本的**索引号**

### 4. 应用系统镜像到C盘
```cmd
dism /apply-image /imagefile:D:\sources\install.wim /index:1 /applydir:C:\
```
等待进度条跑到100%，提示“操作成功完成”

### 5. 修复引导（写入BIOS兼容的引导）
对于 BIOS + MBR，引导文件应放在系统分区的 `\Boot` 文件夹，使用以下命令：

```cmd
bcdboot C:\Windows /s C: /f BIOS
```
- `/s C:` 指定引导文件存放的分区（即系统分区本身）
- `/f BIOS` 明确指定生成BIOS模式的引导

### 6. 可选：写入主引导记录（确保万无一失）
某些情况下，还需要更新硬盘的主引导记录（MBR），可以使用 `bootsect` 命令：

```cmd
bootsect /nt60 C: /mbr
```

### 7. 重启电脑
输入 `exit` 关闭CMD，拔掉U盘，重启电脑接下来就是熟悉的Windows初始化界面了

## 关于 ESD

如果你只是正常下载ISO，你应该处理不到它

很简单，你只需要把 `install.wim` 换成 `install.wim` 即可

本作者目前还没有见过 `Windows` 图形化的安装映像除了 `.wim` 和 `.esd` 的

不要拿你的**民间自制的映像**往上面套，要用官方发布的（或者你保证 `install` 文件内部结构不变也行）